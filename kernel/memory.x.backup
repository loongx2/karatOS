MEMORY
{
  /* NOTE 1 K = 1 KiBi = 1024 bytes */
  /* These values correspond to the LM3S6965, one of the few devices QEMU can emulate */
  FLASH : ORIGIN = 0x00000000, LENGTH = 256K
  RAM : ORIGIN = 0x20000000, LENGTH = 64K
}

/* Stack at top of RAM */
_stack_start = ORIGIN(RAM) + LENGTH(RAM);

SECTIONS
{
  /* Vector table must be first */
  .vector_table ORIGIN(FLASH) : 
  {
    KEEP(*(.vector_table));
  } > FLASH

  /* Code section */
  .text : 
  {
    *(.text .text.*);
  } > FLASH

  /* Read-only data */
  .rodata : 
  {
    *(.rodata .rodata.*);
  } > FLASH

  /* Data section (copied from flash to RAM at startup) */
  .data : 
  {
    . = ALIGN(4);
    __sdata = .;
    *(.data .data.*);
    . = ALIGN(4);
    __edata = .;
  } > RAM AT > FLASH
  
  __sidata = LOADADDR(.data);

  /* BSS section (zero-initialized) */
  .bss : 
  {
    . = ALIGN(4);
    __sbss = .;
    *(.bss .bss.*);
    *(COMMON);
    . = ALIGN(4);
    __ebss = .;
  } > RAM

  /* Discard unwanted sections */
  /DISCARD/ :
  {
    *(.ARM.exidx*);
  }
}
